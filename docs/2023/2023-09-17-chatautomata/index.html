<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Introducing ChatAutomata | Kean Teng Blog</title>
<meta name="keywords" content="Python, Streamlit, Automation">
<meta name="description" content="Reporting Workflow Automation With BlueAutomata">
<meta name="author" content="Kean Teng Blog">
<link rel="canonical" href="https://keanteng.github.io/home/docs/2023/2023-09-17-chatautomata/">
<link crossorigin="anonymous" href="/home/assets/css/stylesheet.3609ac0fb85d7c541bc02f22afb84e98fecc845be8138dfe1ac5d77feae14cb1.css" integrity="sha256-NgmsD7hdfFQbwC8ir7hOmP7MhFvoE43&#43;GsXXf&#43;rhTLE=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://i.postimg.cc/0Qq5g2fX/favicon.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://keanteng.github.io/home/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://keanteng.github.io/home/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://keanteng.github.io/home/apple-touch-icon.png">
<link rel="mask-icon" href="https://keanteng.github.io/home/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Introducing ChatAutomata" />
<meta property="og:description" content="Reporting Workflow Automation With BlueAutomata" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://keanteng.github.io/home/docs/2023/2023-09-17-chatautomata/" /><meta property="og:image" content="https://keanteng.github.io/home/papermod-cover.png"/><meta property="article:section" content="docs" />
<meta property="article:published_time" content="2023-09-17T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-09-17T00:00:00+00:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://keanteng.github.io/home/papermod-cover.png"/>

<meta name="twitter:title" content="Introducing ChatAutomata"/>
<meta name="twitter:description" content="Reporting Workflow Automation With BlueAutomata"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Docs",
      "item": "https://keanteng.github.io/home/docs/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Introducing ChatAutomata",
      "item": "https://keanteng.github.io/home/docs/2023/2023-09-17-chatautomata/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Introducing ChatAutomata",
  "name": "Introducing ChatAutomata",
  "description": "Reporting Workflow Automation With BlueAutomata",
  "keywords": [
    "Python", "Streamlit", "Automation"
  ],
  "articleBody": " Images from Unsplash\nFrom my previous article, I have introduced a Python package blueautomata that is capable of providing the framework for reporting workflow automation. In this article, I provide example to integrate the package into application, preferably a Chatbot as an agent as we are seeing user-agent interaction is starting to redefine how do we work today in industry. The usage of Chatbot is helping us to perform routine tasks more quickly so that more time can be spent on something more productive and meaningful.\nThe package can be installed by calling:\npip install blueautomata Hereâ€™s an overview of the function of blueautomata, this is a case study that explain how to use the package:\nData Compilation Compiling files in folder as a single dataframe Categorized File Export Exporting the compiled dataframe as individual Excel files by Department VBA Automation Applying macros on the exported Excel files Output Foresight Receive status report of the output from data compilation Inconsistency Data Entry Fix Perform fixes to the name column for wrong names System and Cube Checking Perform update and change to the content of the system and cube column To create ChatAutomata we will create three web pages using streamlit that utilizes all the package functionality.\nMain page A one-stop station to user perform data compilation. output foresight, categorized file export and VBA automation Inconsistency Page A page to allow user to fix the inconsistency data entry System Cube Update Page A page to allow user update the content of the system and cube column Main Page This is how the main page should look like. In the main page, the user can edit the page setting where it contains parameters that will be used by the blueautomata package:\nwith st.chat_message(\"assistant\", avatar=\"favicon.png\"): st.write(\"Hi there, welcome to the tutorial: Managing Data With Makima\") st.write(\"You can see your setting here:\") with st.expander(\"ðŸ”¨ Page Settings\", expanded = False): your_checklist_path = st.text_input(\"Enter your checklist path here:\", \"kaggledata/checklist.xlsx\") your_staff_data_path = st.text_input(\"Enter your staff data path here:\", \"kaggledata/hr.xlsx\") your_name_key = st.multiselect(\"Enter your files keywords here:\", [\"action\",\"adventure\",\"comedy\",\"drama\",\"horror\",\"isekai\",\"romance\",\"sci-fi\",\"slice of life\"]) your_name_code = st.number_input(\"Enter your execution code here:\", 1) st.write(\"After changing the setting, you can begin the automation:\") submitted = st.button(\"Submit For Automation\", type='primary') After the users select the parameter, they can click on the Submit for Automation button to start processing the data and the program will show the processes in a series of steps:\nStep 1\ntest = BlueAutomata( folder_path= folder_location, checklist=your_checklist_path, staff_data= your_staff_data_path, name_key= your_name_key, name_code=nameCode, ) df = test.automata_execution() with st.chat_message(\"assistant\", avatar=\"favicon.png\"): st.write(\"Step 1: Automata Compilataion\") st.write(\"Number of rows processed: \", df.shape[0], \" The output is saved as: `output.xlsx`\") st.dataframe(df.head()) Step 1\nStep 2\ntest = AutomataReport( folder_path=folder_location, checklist=your_checklist_path, staff_data=your_staff_data_path, name_key=your_name_key, name_code=nameCode, ) df = test.automata_report_summary() df1 = test.automata_report_unmatch() with st.chat_message(\"assistant\", avatar=\"favicon.png\"): st.write(\"Step 2: Automata Report:\") st.write(\"This is the execution report, you should expect \", df['Match IDs'].sum(), \" number of matches\") st.write(\"It seems that you do not have any unmatched IDs.\") st.dataframe(df.head(n = len(df))) st.dataframe(df1.head()) Step 2\nStep 3\nwith st.chat_message(\"assistant\", avatar=\"favicon.png\"): st.write(\"Step 3: Batch Export By Department\") df = pd.read_excel(\"output.xlsx\") temp = BatchExport( destination=\"dept\", masterlist=df, ) temp.batch_export() st.markdown(\"\"\"Your files are successfully exported by Department at the `dept` folder.\"\"\") Step 3\nwith st.chat_message(\"assistant\", avatar=\"favicon.png\"): with st.expander(\"VBA Macros Terminal\"): markdown = \"\"\" Step 4: VBA Automation Do you wish to proceed with VBA automation? This process is not reversible. Please proceed with caution. \"\"\" st.markdown(markdown) submit = st.button(\"Activate Macros\") Step 4\nIf the users trigger the macros button, then this function will be run:\nif submit: with st.chat_message(\"assistant\", avatar=\"favicon.png\"): with st.spinner(\"Automating ... This process might take one minute ...\"): xl = win32com.client.Dispatch(\"Excel.Application\",pythoncom.CoInitialize()) temp = automate_vba( filepath=r\"C:\\\\Users\\\\sskkteng\\\\Downloads\\\\BlueAutomata Testing\\\\vbanew.xlsm\", macro=\"vbanew.xlsm!Module1.kt_template\", ) temp.templatetize() st.write(\"\"\"Execution Completed!\"\"\") Inconsistency Page We can use the same approach that we used earlier to build the inconsistency page. The steps are previewing data, show the updated data and show the data that cannot be updated or fixed:\nPage Setting\nwith st.chat_message(\"assistant\", avatar=\"favicon.png\"): st.write(\"Hi there, you can see you setting here:\") with st.expander(\"Page settings\", expanded= False): your_file_path = st.text_input(\"Enter the file path here:\", \"kaggledata/sample1.xlsx\") your_checklist_path = st.text_input(\"Enter your checklist path here:\", \"kaggledata/checklist.xlsx\") your_staff_data_path = st.text_input(\"Enter your staff data path here:\", \"kaggledata/hr.xlsx\") your_sheet_number = st.number_input(\"Enter the sheet number:\", 0) submitted = st.button(\"Submit For Automation\") Page Setting\nStep 1:\nwith st.chat_message(\"assistant\", avatar=\"favicon.png\"): st.write(\"Step 1: Data preview\") st.markdown(\"\"\"Let's have a look at the data\"\"\") preview = pd.read_excel(\"kaggledata/sample1.xlsx\") st.dataframe(preview.head(n = 6)) test = Inconsistency( filepath=your_file_path, staff_data=your_staff_data_path, checklist=your_checklist_path, sheet_number=your_sheet_number, ) Step 1\nStep 2:\ndf = test.fix_inconsistency() with st.chat_message(\"assistant\", avatar=\"favicon.png\"): st.write(\"Step 1: Fixed Data Overview\") st.write(\"The table below shows the fixed data. \", len(df), \" rows are fixed\") st.dataframe(df.head(n = len(df))) Step 2\nStep 3:\nwith st.chat_message(\"assistant\", avatar=\"favicon.png\"): st.write(\"Step 3: Show the name that cannot be fixed\") st.write(\"There is/are \", len(df), \" rows the program cannot fix. These names are not searcheable.\") st.dataframe(df.head()) Step 3\nSystem Cube Update Page Now, letâ€™s use the same approach again to build the system cube update page.\nPage Setting:\nwith st.chat_message(\"assistant\", avatar=\"favicon.png\"): st.write(\"Hi there, you can see your setting here:\") with st.expander(\"Page setting\", expanded= False): your_file_path = st.selectbox(\"Enter the file path here:\", (\"kaggledata/sample2.xlsx\", \"update.xlsx\")) your_system = st.multiselect(\"Choose the system you want to check: \", ['Mappa', 'ufotable']) your_cube = st.multiselect(\"Choose the cube to assign: \", ['Action', 'Adventure']) submitted = st.button(\"Submit For Automation\") Page Setting\nStep 1:\nwith st.spinner(\"Computing ... Please Wait ...\"): with st.chat_message(\"assistant\", avatar=\"favicon.png\"): st.write(\"Step 1: Preview the data\") st.markdown(\"\"\"Let's have a look at the data\"\"\") preview = pd.read_excel(your_file_path) st.dataframe(preview.head()) Step 1\nStep 2:\nwith st.chat_message(\"assistant\", avatar=\"favicon.png\"): st.write(\"Step 2: Performing fixes\") st.markdown(\"\"\"You can check the fixed data. The output is saved to `update.xlsx`\"\"\") test = SystemCubeChecker( masterlistpath=your_file_path, system_to_check=your_system, cube_to_assign=your_cube[0], ) df = test.system_cube_update() df.to_excel(\"update.xlsx\", index=False) preview2 = pd.read_excel(\"update.xlsx\") st.dataframe(preview2.head()) Step 2\n",
  "wordCount" : "936",
  "inLanguage": "en",
  "datePublished": "2023-09-17T00:00:00Z",
  "dateModified": "2023-09-17T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Kean Teng Blog"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://keanteng.github.io/home/docs/2023/2023-09-17-chatautomata/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Kean Teng Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://i.postimg.cc/0Qq5g2fX/favicon.png"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://keanteng.github.io/home/" accesskey="h" title="Kean Teng Blog (Alt + H)">Kean Teng Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://keanteng.github.io/home/archives/" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://keanteng.github.io/home/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://keanteng.github.io/home/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://keanteng.github.io/home/projects/" title="Projects">
                    <span>Projects</span>
                </a>
            </li>
            <li>
                <a href="https://keanteng.github.io/home/faqs/" title="FAQs">
                    <span>FAQs</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://keanteng.github.io/home/">Home</a>&nbsp;Â»&nbsp;<a href="https://keanteng.github.io/home/docs/">Docs</a></div>
    <h1 class="post-title">
      Introducing ChatAutomata
    </h1>
    <div class="post-description">
      Reporting Workflow Automation With BlueAutomata
    </div>
    <div class="post-meta"><span title='2023-09-17 00:00:00 +0000 UTC'>September 17, 2023</span>&nbsp;Â·&nbsp;5 min&nbsp;Â·&nbsp;Kean Teng Blog

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#main-page" aria-label="Main Page">Main Page</a></li>
                <li>
                    <a href="#inconsistency-page" aria-label="Inconsistency Page">Inconsistency Page</a></li>
                <li>
                    <a href="#system-cube-update-page" aria-label="System Cube Update Page">System Cube Update Page</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><center><img src="https://images.unsplash.com/photo-1692607431259-951c39946cbf?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1932&q=80"  class = "center"/></center>
<p style="text-align: center; color:grey;"><i>Images from Unsplash</i></p>
<p>From my previous article, I have introduced a <a href="https://github.com/keanteng/blueautomata">Python package</a> <code>blueautomata</code> that is capable of providing the framework for reporting workflow automation. In this article, I provide example to integrate the package into application, preferably a Chatbot as an agent as we are seeing user-agent interaction is starting to redefine how do we work today in industry. The usage of Chatbot is helping us to perform routine tasks more quickly so that more time can be spent on something more productive and meaningful.</p>
<p>The package can be installed by calling:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">pip</span> <span class="n">install</span> <span class="n">blueautomata</span>
</span></span></code></pre></div><p>Here&rsquo;s an overview of the function of <code>blueautomata</code>, this is a <a href="https://keanteng.github.io/blueautomata/casestudy/">case study</a> that explain how to use the package:</p>
<ol>
<li>Data Compilation
<ol>
<li>Compiling files in folder as a single dataframe</li>
</ol>
</li>
<li>Categorized File Export
<ol>
<li>Exporting the compiled dataframe as individual Excel files by Department</li>
</ol>
</li>
<li>VBA Automation
<ol>
<li>Applying macros on the exported Excel files</li>
</ol>
</li>
<li>Output Foresight
<ol>
<li>Receive status report of the output from data compilation</li>
</ol>
</li>
<li>Inconsistency Data Entry Fix
<ol>
<li>Perform fixes to the <code>name</code> column for wrong names</li>
</ol>
</li>
<li>System and Cube Checking
<ol>
<li>Perform update and change to the content of the <code>system</code> and <code>cube</code> column</li>
</ol>
</li>
</ol>
<p>To create <code>ChatAutomata</code> we will create three web pages using <code>streamlit</code> that utilizes all the package functionality.</p>
<ul>
<li>Main page
<ul>
<li>A one-stop station to user perform data compilation. output foresight, categorized file export and VBA automation</li>
</ul>
</li>
<li>Inconsistency Page
<ul>
<li>A page to allow user to fix the inconsistency data entry</li>
</ul>
</li>
<li>System Cube Update Page
<ul>
<li>A page to allow user update the content of the <code>system</code> and <code>cube</code> column</li>
</ul>
</li>
</ul>
<h2 id="main-page">Main Page<a hidden class="anchor" aria-hidden="true" href="#main-page">#</a></h2>
<p>This is how the main page should look like. In the main page, the user can edit the page setting where it contains parameters that will be used by the <code>blueautomata</code> package:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">chat_message</span><span class="p">(</span><span class="s2">&#34;assistant&#34;</span><span class="p">,</span> <span class="n">avatar</span><span class="o">=</span><span class="s2">&#34;favicon.png&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;Hi there, welcome to the tutorial: Managing Data With Makima&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;You can see your setting here:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">expander</span><span class="p">(</span><span class="s2">&#34;ðŸ”¨ Page Settings&#34;</span><span class="p">,</span> <span class="n">expanded</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">your_checklist_path</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">text_input</span><span class="p">(</span><span class="s2">&#34;Enter your checklist path here:&#34;</span><span class="p">,</span> <span class="s2">&#34;kaggledata/checklist.xlsx&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">your_staff_data_path</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">text_input</span><span class="p">(</span><span class="s2">&#34;Enter your staff data path here:&#34;</span><span class="p">,</span> <span class="s2">&#34;kaggledata/hr.xlsx&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">your_name_key</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">multiselect</span><span class="p">(</span><span class="s2">&#34;Enter your files keywords here:&#34;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&#34;action&#34;</span><span class="p">,</span><span class="s2">&#34;adventure&#34;</span><span class="p">,</span><span class="s2">&#34;comedy&#34;</span><span class="p">,</span><span class="s2">&#34;drama&#34;</span><span class="p">,</span><span class="s2">&#34;horror&#34;</span><span class="p">,</span><span class="s2">&#34;isekai&#34;</span><span class="p">,</span><span class="s2">&#34;romance&#34;</span><span class="p">,</span><span class="s2">&#34;sci-fi&#34;</span><span class="p">,</span><span class="s2">&#34;slice of life&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">your_name_code</span> <span class="o">=</span>  <span class="n">st</span><span class="o">.</span><span class="n">number_input</span><span class="p">(</span><span class="s2">&#34;Enter your execution code here:&#34;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;After changing the setting, you can begin the automation:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">submitted</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s2">&#34;Submit For Automation&#34;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;primary&#39;</span><span class="p">)</span>
</span></span></code></pre></div><center><img src="image.png"  class = "center"/></center>
<p>After the users select the parameter, they can click on the <code>Submit for Automation</code> button to start processing the data and the program will show the processes in a series of steps:</p>
<p><strong>Step 1</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">test</span> <span class="o">=</span> <span class="n">BlueAutomata</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">   <span class="n">folder_path</span><span class="o">=</span> <span class="n">folder_location</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="n">checklist</span><span class="o">=</span><span class="n">your_checklist_path</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="n">staff_data</span><span class="o">=</span> <span class="n">your_staff_data_path</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="n">name_key</span><span class="o">=</span> <span class="n">your_name_key</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="n">name_code</span><span class="o">=</span><span class="n">nameCode</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">automata_execution</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">chat_message</span><span class="p">(</span><span class="s2">&#34;assistant&#34;</span><span class="p">,</span> <span class="n">avatar</span><span class="o">=</span><span class="s2">&#34;favicon.png&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">   <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;Step 1: Automata Compilataion&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;Number of rows processed: &#34;</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&#34; The output is saved as: `output.xlsx`&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="n">st</span><span class="o">.</span><span class="n">dataframe</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</span></span></code></pre></div><center><img src="image-1.png"  class = "center"/></center>
<p style="text-align: center; color:grey;"><i>Step 1</i></p>
<p><strong>Step 2</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">test</span> <span class="o">=</span> <span class="n">AutomataReport</span><span class="p">(</span>
</span></span><span class="line"><span class="cl"><span class="n">folder_path</span><span class="o">=</span><span class="n">folder_location</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="n">checklist</span><span class="o">=</span><span class="n">your_checklist_path</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="n">staff_data</span><span class="o">=</span><span class="n">your_staff_data_path</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="n">name_key</span><span class="o">=</span><span class="n">your_name_key</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="n">name_code</span><span class="o">=</span><span class="n">nameCode</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">automata_report_summary</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">df1</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">automata_report_unmatch</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">chat_message</span><span class="p">(</span><span class="s2">&#34;assistant&#34;</span><span class="p">,</span> <span class="n">avatar</span><span class="o">=</span><span class="s2">&#34;favicon.png&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">   <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;Step 2: Automata Report:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;This is the execution report, you should expect &#34;</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Match IDs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="s2">&#34; number of matches&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;It seems that you do not have any unmatched IDs.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="n">st</span><span class="o">.</span><span class="n">dataframe</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">   <span class="n">st</span><span class="o">.</span><span class="n">dataframe</span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</span></span></code></pre></div><center><img src="image-2.png"  class = "center"/></center>
<p style="text-align: center; color:grey;"><i>Step 2</i></p>
<p><strong>Step 3</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">chat_message</span><span class="p">(</span><span class="s2">&#34;assistant&#34;</span><span class="p">,</span> <span class="n">avatar</span><span class="o">=</span><span class="s2">&#34;favicon.png&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">   <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;Step 3: Batch Export By Department&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl">   <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&#34;output.xlsx&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="n">temp</span> <span class="o">=</span> <span class="n">BatchExport</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">         <span class="n">destination</span><span class="o">=</span><span class="s2">&#34;dept&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">masterlist</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="n">temp</span><span class="o">.</span><span class="n">batch_export</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&#34;&#34;&#34;Your files are successfully exported by Department at the `dept` folder.&#34;&#34;&#34;</span><span class="p">)</span>
</span></span></code></pre></div><center><img src="image-3.png"  class = "center"/></center>
<p style="text-align: center; color:grey;"><i>Step 3</i></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">chat_message</span><span class="p">(</span><span class="s2">&#34;assistant&#34;</span><span class="p">,</span> <span class="n">avatar</span><span class="o">=</span><span class="s2">&#34;favicon.png&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">expander</span><span class="p">(</span><span class="s2">&#34;VBA Macros Terminal&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">markdown</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">                Step 4: VBA Automation
</span></span></span><span class="line"><span class="cl"><span class="s2">                
</span></span></span><span class="line"><span class="cl"><span class="s2">                Do you wish to proceed with VBA automation? This process is not reversible. Please proceed with caution.
</span></span></span><span class="line"><span class="cl"><span class="s2">            &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="n">markdown</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">submit</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s2">&#34;Activate Macros&#34;</span><span class="p">)</span>
</span></span></code></pre></div><center><img src="image-4.png"  class = "center"/></center>
<p style="text-align: center; color:grey;"><i>Step 4</i></p>
<p>If the users trigger the <code>macros</code> button, then this function will be run:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="k">if</span> <span class="n">submit</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">chat_message</span><span class="p">(</span><span class="s2">&#34;assistant&#34;</span><span class="p">,</span> <span class="n">avatar</span><span class="o">=</span><span class="s2">&#34;favicon.png&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">spinner</span><span class="p">(</span><span class="s2">&#34;Automating ... This process might take one minute ...&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">xl</span> <span class="o">=</span> <span class="n">win32com</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">Dispatch</span><span class="p">(</span><span class="s2">&#34;Excel.Application&#34;</span><span class="p">,</span><span class="n">pythoncom</span><span class="o">.</span><span class="n">CoInitialize</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="n">temp</span> <span class="o">=</span> <span class="n">automate_vba</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="n">filepath</span><span class="o">=</span><span class="sa">r</span><span class="s2">&#34;C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">sskkteng</span><span class="se">\\</span><span class="s2">Downloads</span><span class="se">\\</span><span class="s2">BlueAutomata Testing</span><span class="se">\\</span><span class="s2">vbanew.xlsm&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">macro</span><span class="o">=</span><span class="s2">&#34;vbanew.xlsm!Module1.kt_template&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="n">temp</span><span class="o">.</span><span class="n">templatetize</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;&#34;&#34;Execution Completed!&#34;&#34;&#34;</span><span class="p">)</span>    
</span></span></code></pre></div><h2 id="inconsistency-page">Inconsistency Page<a hidden class="anchor" aria-hidden="true" href="#inconsistency-page">#</a></h2>
<p>We can use the same approach that we used earlier to build the inconsistency page. The steps are previewing data, show the updated data and show the data that cannot be updated or fixed:</p>
<p><strong>Page Setting</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">chat_message</span><span class="p">(</span><span class="s2">&#34;assistant&#34;</span><span class="p">,</span> <span class="n">avatar</span><span class="o">=</span><span class="s2">&#34;favicon.png&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;Hi there, you can see you setting here:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">expander</span><span class="p">(</span><span class="s2">&#34;Page settings&#34;</span><span class="p">,</span> <span class="n">expanded</span><span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">your_file_path</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">text_input</span><span class="p">(</span><span class="s2">&#34;Enter the file path here:&#34;</span><span class="p">,</span> <span class="s2">&#34;kaggledata/sample1.xlsx&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">your_checklist_path</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">text_input</span><span class="p">(</span><span class="s2">&#34;Enter your checklist path here:&#34;</span><span class="p">,</span> <span class="s2">&#34;kaggledata/checklist.xlsx&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">your_staff_data_path</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">text_input</span><span class="p">(</span><span class="s2">&#34;Enter your staff data path here:&#34;</span><span class="p">,</span> <span class="s2">&#34;kaggledata/hr.xlsx&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">your_sheet_number</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">number_input</span><span class="p">(</span><span class="s2">&#34;Enter the sheet number:&#34;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">submitted</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s2">&#34;Submit For Automation&#34;</span><span class="p">)</span>
</span></span></code></pre></div><center><img src="image-5.png"  class = "center"/></center>
<p style="text-align: center; color:grey;"><i>Page Setting</i></p>
<p><strong>Step 1:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">chat_message</span><span class="p">(</span><span class="s2">&#34;assistant&#34;</span><span class="p">,</span> <span class="n">avatar</span><span class="o">=</span><span class="s2">&#34;favicon.png&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">   <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;Step 1: Data preview&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&#34;&#34;&#34;Let&#39;s have a look at the data&#34;&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="n">preview</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&#34;kaggledata/sample1.xlsx&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="n">st</span><span class="o">.</span><span class="n">dataframe</span><span class="p">(</span><span class="n">preview</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="mi">6</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">test</span> <span class="o">=</span> <span class="n">Inconsistency</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">   <span class="n">filepath</span><span class="o">=</span><span class="n">your_file_path</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="n">staff_data</span><span class="o">=</span><span class="n">your_staff_data_path</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="n">checklist</span><span class="o">=</span><span class="n">your_checklist_path</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="n">sheet_number</span><span class="o">=</span><span class="n">your_sheet_number</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></div><center><img src="image-6.png"  class = "center"/></center>
<p style="text-align: center; color:grey;"><i>Step 1</i></p>
<p><strong>Step 2:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">fix_inconsistency</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">chat_message</span><span class="p">(</span><span class="s2">&#34;assistant&#34;</span><span class="p">,</span> <span class="n">avatar</span><span class="o">=</span><span class="s2">&#34;favicon.png&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">   <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;Step 1: Fixed Data Overview&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;The table below shows the fixed data. &#34;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="s2">&#34; rows are fixed&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="n">st</span><span class="o">.</span><span class="n">dataframe</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)))</span>
</span></span></code></pre></div><center><img src="image-7.png"  class = "center"/></center>
<p style="text-align: center; color:grey;"><i>Step 2</i></p>
<p><strong>Step 3:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">chat_message</span><span class="p">(</span><span class="s2">&#34;assistant&#34;</span><span class="p">,</span> <span class="n">avatar</span><span class="o">=</span><span class="s2">&#34;favicon.png&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">   <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;Step 3: Show the name that cannot be fixed&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;There is/are &#34;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="s2">&#34; rows the program cannot fix. These names are not searcheable.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="n">st</span><span class="o">.</span><span class="n">dataframe</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</span></span></code></pre></div><center><img src="image-8.png"  class = "center"/></center>
<p style="text-align: center; color:grey;"><i>Step 3</i></p>
<h2 id="system-cube-update-page">System Cube Update Page<a hidden class="anchor" aria-hidden="true" href="#system-cube-update-page">#</a></h2>
<p>Now, let&rsquo;s use the same approach again to build the <code>system cube update</code> page.</p>
<p><strong>Page Setting:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">chat_message</span><span class="p">(</span><span class="s2">&#34;assistant&#34;</span><span class="p">,</span> <span class="n">avatar</span><span class="o">=</span><span class="s2">&#34;favicon.png&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;Hi there, you can see your setting here:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">expander</span><span class="p">(</span><span class="s2">&#34;Page setting&#34;</span><span class="p">,</span> <span class="n">expanded</span><span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">your_file_path</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">selectbox</span><span class="p">(</span><span class="s2">&#34;Enter the file path here:&#34;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&#34;kaggledata/sample2.xlsx&#34;</span><span class="p">,</span> <span class="s2">&#34;update.xlsx&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="n">your_system</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">multiselect</span><span class="p">(</span><span class="s2">&#34;Choose the system you want to check: &#34;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Mappa&#39;</span><span class="p">,</span> <span class="s1">&#39;ufotable&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">your_cube</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">multiselect</span><span class="p">(</span><span class="s2">&#34;Choose the cube to assign: &#34;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Action&#39;</span><span class="p">,</span> <span class="s1">&#39;Adventure&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">submitted</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s2">&#34;Submit For Automation&#34;</span><span class="p">)</span>
</span></span></code></pre></div><center><img src="image-9.png"  class = "center"/></center>
<p style="text-align: center; color:grey;"><i>Page Setting</i></p>
<p><strong>Step 1:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">spinner</span><span class="p">(</span><span class="s2">&#34;Computing ... Please Wait ...&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">   <span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">chat_message</span><span class="p">(</span><span class="s2">&#34;assistant&#34;</span><span class="p">,</span> <span class="n">avatar</span><span class="o">=</span><span class="s2">&#34;favicon.png&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">      <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;Step 1: Preview the data&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&#34;&#34;&#34;Let&#39;s have a look at the data&#34;&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="n">preview</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">your_file_path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">st</span><span class="o">.</span><span class="n">dataframe</span><span class="p">(</span><span class="n">preview</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</span></span></code></pre></div><center><img src="image-10.png"  class = "center"/></center>
<p style="text-align: center; color:grey;"><i>Step 1</i></p>
<p><strong>Step 2:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">chat_message</span><span class="p">(</span><span class="s2">&#34;assistant&#34;</span><span class="p">,</span> <span class="n">avatar</span><span class="o">=</span><span class="s2">&#34;favicon.png&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">   <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;Step 2: Performing fixes&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&#34;&#34;&#34;You can check the fixed data. The output is saved to `update.xlsx`&#34;&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="n">test</span> <span class="o">=</span> <span class="n">SystemCubeChecker</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">         <span class="n">masterlistpath</span><span class="o">=</span><span class="n">your_file_path</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">system_to_check</span><span class="o">=</span><span class="n">your_system</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">cube_to_assign</span><span class="o">=</span><span class="n">your_cube</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">   <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="n">df</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">system_cube_update</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">   <span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s2">&#34;update.xlsx&#34;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="n">preview2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&#34;update.xlsx&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="n">st</span><span class="o">.</span><span class="n">dataframe</span><span class="p">(</span><span class="n">preview2</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</span></span></code></pre></div><center><img src="image-11.png"  class = "center"/></center>
<p style="text-align: center; color:grey;"><i>Step 2</i></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://keanteng.github.io/home/tags/python/">Python</a></li>
      <li><a href="https://keanteng.github.io/home/tags/streamlit/">Streamlit</a></li>
      <li><a href="https://keanteng.github.io/home/tags/automation/">Automation</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://keanteng.github.io/home/docs/2023/2023-09-17-creating-chatfloodrisk/">
    <span class="title">Â« Prev</span>
    <br>
    <span>Creating ChatFloodRisk</span>
  </a>
  <a class="next" href="https://keanteng.github.io/home/docs/2023/2023-09-07-introducing-blue-automata/">
    <span class="title">Next Â»</span>
    <br>
    <span>Introducing BlueAutomata</span>
  </a>
</nav>


<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share Introducing ChatAutomata on twitter"
        href="https://twitter.com/intent/tweet/?text=Introducing%20ChatAutomata&amp;url=https%3a%2f%2fkeanteng.github.io%2fhome%2fdocs%2f2023%2f2023-09-17-chatautomata%2f&amp;hashtags=Python%2cStreamlit%2cAutomation">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Introducing ChatAutomata on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fkeanteng.github.io%2fhome%2fdocs%2f2023%2f2023-09-17-chatautomata%2f&amp;title=Introducing%20ChatAutomata&amp;summary=Introducing%20ChatAutomata&amp;source=https%3a%2f%2fkeanteng.github.io%2fhome%2fdocs%2f2023%2f2023-09-17-chatautomata%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Introducing ChatAutomata on reddit"
        href="https://reddit.com/submit?url=https%3a%2f%2fkeanteng.github.io%2fhome%2fdocs%2f2023%2f2023-09-17-chatautomata%2f&title=Introducing%20ChatAutomata">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Introducing ChatAutomata on facebook"
        href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fkeanteng.github.io%2fhome%2fdocs%2f2023%2f2023-09-17-chatautomata%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Introducing ChatAutomata on whatsapp"
        href="https://api.whatsapp.com/send?text=Introducing%20ChatAutomata%20-%20https%3a%2f%2fkeanteng.github.io%2fhome%2fdocs%2f2023%2f2023-09-17-chatautomata%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Introducing ChatAutomata on telegram"
        href="https://telegram.me/share/url?text=Introducing%20ChatAutomata&amp;url=https%3a%2f%2fkeanteng.github.io%2fhome%2fdocs%2f2023%2f2023-09-17-chatautomata%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
</div>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://keanteng.github.io/home/">Kean Teng Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
