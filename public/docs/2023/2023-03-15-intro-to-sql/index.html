<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/home/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=home/livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Intro to SQL | Kean Teng Blog</title>
<meta name="keywords" content="Python, SQL, Data Analysis, Kaggle">
<meta name="description" content="My Kaggle Learning Note 4">
<meta name="author" content="Kean Teng Blog">
<link rel="canonical" href="http://localhost:1313/home/docs/2023/2023-03-15-intro-to-sql/">
<link crossorigin="anonymous" href="/home/assets/css/stylesheet.f17a9624778dfac7448fc86c3c6a69a779fa508c246988454db1bc46af2a4aa1.css" integrity="sha256-8XqWJHeN&#43;sdEj8hsPGppp3n6UIwkaYhFTbG8Rq8qSqE=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://i.postimg.cc/0Qq5g2fX/favicon.png">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/home/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/home/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/home/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/home/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/home/docs/2023/2023-03-15-intro-to-sql/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="http://localhost:1313/home/docs/2023/2023-03-15-intro-to-sql/">
  <meta property="og:site_name" content="Kean Teng Blog">
  <meta property="og:title" content="Intro to SQL">
  <meta property="og:description" content="My Kaggle Learning Note 4">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">
    <meta property="article:published_time" content="2023-03-15T00:00:00+00:00">
    <meta property="article:modified_time" content="2023-03-15T00:00:00+00:00">
    <meta property="article:tag" content="Python">
    <meta property="article:tag" content="SQL">
    <meta property="article:tag" content="Data Analysis">
    <meta property="article:tag" content="Kaggle">
      <meta property="og:image" content="http://localhost:1313/home/papermod-cover.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://localhost:1313/home/papermod-cover.png">
<meta name="twitter:title" content="Intro to SQL">
<meta name="twitter:description" content="My Kaggle Learning Note 4">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Docs",
      "item": "http://localhost:1313/home/docs/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Intro to SQL",
      "item": "http://localhost:1313/home/docs/2023/2023-03-15-intro-to-sql/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Intro to SQL",
  "name": "Intro to SQL",
  "description": "My Kaggle Learning Note 4",
  "keywords": [
    "Python", "SQL", "Data Analysis", "Kaggle"
  ],
  "articleBody": "\rImages from Unsplash\nDisclaimer: This article is my learning note from the courses I took from Kaggle.\nFor examining and assessing huge datasets and databases, SQL or structured programming language skills plays a vital role to enable us to design and manage data.\nSome common keywords used in SQL as follows:\nSELECT, WHERE, FROM GROUP BY, HAVING, COUNT ORDER BY AS, WITH JOIN 1. Data Preparation Since we will be using Python to apply SQL, there are some steps required for data preparation. We will first start by establishing a connection to the BigQuery service to create a client object that hold projects. We will then select a project from the biquery-public-data which holds a collection of datasets for each project. The datasets will contain the tables that we want for our analysis. Here’s how we can do that in Python:\nfrom google.cloud import bigquery # 1. create a client object client = bigquery.Client() dataset_ref = client.dataset(\"hacker-news\", project = \"bigquery-public-data\") # 2. get the hacker news dataset from a project dataset = client.get_dataset(dataset_ref) # 3. list the tables in the datasets tables = list(client.list_tables(dataset)) # 4. print the all the table names for table in table: print(table.table_id) Now from the code we learn about all the table names in the datasets from the printed outputs. Here’s how we can fetch the table with code:\n# create a reference to the table name full table_ref = dataset_ref.table(\"full\") # get the table table = client.get_table(table_ref) Oftentimes, when we want to preview at the table before our analysis, but it contains a huge number of rows and might consume resources to load, we can choose to display only a certain number of rows of the table.\n# Restrict rows and convert the result to dataframe client.list_rows(table, max_results = 5).to_dataframe() 1.1 Table Schema The structure of a table is known as table schema, and it will tell us information about each specific columns in our table. The information is:\nName of the column Datatype of the column Mode of the column (by default it will allow null values — nullable) Description of the data in the particular column # code command table.schema # Output: [SchemaField('title', 'STRING', 'NULLABLE', 'Story title', (), None)] 2. Queries Foundations We will start by three keywords which represents the foundational components of a SQL query, namely SELECT, FROM and WHERE.\nBy SELECT, it refers to the columns that we want to select, FROM refers to the table that we are after and finally WHERE refers to the return condition that we want to impose on the output. Below is how we can select the cat owner’s name from an imaginary dataset:\nAn imaginary dataset\nquery = \"\"\" SELECT Name FROM `bigquery-public-data.pet_records.pets` WHERE Animal = 'Dog' \"\"\" 2.1 Big Datasets Some BigQuery datasets can be huge and costly to compute. If you are running them on cloud services with limited computing hours, your limit might drain easily with huge datasets. We can avoid this issue by imposing a function to limit the amount of data that we are capable to scan to avoid running over our computing limit.\nHere’s how we can check how much data a query will scan, alternatively we can also impose a limit with a parameter on how much data that will be scanned:\n# query query = \"\"\"\" SELECT score, title FROM `bigquery-public-data.hacker_news.full` WHERE type = \"job\" \"\"\" ## 1. Cost estimation # create object for cost estimation without running it dry_run_config = bigquery.QueryJobConfig(dry_run = True) # estimate cost dry_run_query_job = client.query(query, job_config = dry_run_config) print(\"This query will process {} bytes.\".format(dry_run_query_job.total_bytes_processed)) ## 2. Setting parameter ONE_GB = 1000*1000*1000 # set up the query safe_config = bigquery.QueryJobConfig(maximum_bytes_billed = ONE_GB) # run the query safe_query_job = client.query(query, job_config = safe_config) job_posts_scores = safe_query_job.to_dataframe() job_posts_scores.mean() 3. More Queries 1 This section will add three new techniques: GROUP BY, HAVING and COUNT() to assist us in getting more interesting insights from our queries.\nGROUP BY means grouping together rows with the same value in that column as a single group, COUNT() will return a count of things such as the number of entries of a column while HAVING is used in combination with GROUP BY to ignore groups that do not meet a certain criterion.\nHere is how we can apply these techniques to find the most discussed new comments on the Hacker News project:\n# select comment with \u003e 10 replies query_popular = \"\"\" SELECT parent, COUNT(1) AS NumPosts FROM `bigquery-public-data.hacker_news.comments` GROUP BY parent HAVING COUNT(1) \u003e 10 \"\"\" # limit how much data will be scan safe_config = bigquery.QueryJobConfig(maximum_bytes_billed=10**10) query_job = client.query(query_popular, job_config=safe_config) # run query and convert to data frame popular_comments = query_job.to_dataframe() # print the first five rows popular_comments.head() 4. More Queries 2 In this section, we will learn about ORDER BY clause where it is used to sort the returned results by the rest of the query. When we use ORDER BY the returned results will be sorted in ascending order whether it is string or numeric. If we would like to have the order reverse, we can add in the DESC argument.\nquery = \"\"\" SELECT Name FROM `bigquery-public-data.pet_records.pets` WHERE Animal = 'Dog' ORDER BY Name DESC \"\"\" Now considering we have a column that tell us about the date that a pet owner getting a pet, we can use the EXTRACT clause to get the day, month, week and year information from the column.\n5. More Queries 3 In this section, we will work on two keywords that helps to organize our query for better readability — if we happen we have a complex query. Starting with AS, it is used to rename columns generated by our queries. WITH is used together with AS to create a temporary table so that we can write query against them. This helps us to split queries into readable chunks and makes the data cleaning work easier.\nConsider that we want to know the pet IDs that are owned for more than five years:\nquery = \"\"\" WITH Seniors AS ( SELECT Name, ID FROM `bigquery-public-data.pet_records.pets` WHERE Years_old \u003e 5 ) SELECT ID FROM Seniors \"\"\" Another example is to find how many bitcoins transactions being made in a month:\nquery = \"\"\"\" WITH Time AS ( SELECT DATE(block_timestamp) AS trans_date FROM `bigquery-public-data.crypto_bitcoin.transactions` ) SELECT COUNT(1) AS transactions, trans_date FROM Time GROUP BY trans_date ORDER BY trans_date \"\"\" # limit how much data will be scanned safe_config = bigquery.QueryJobConfig(maximum_bytes_billed=10**10) query_job = client.query(query, job_config=safe_config) # run query and convert to data frame transactions_by_date = query_job.to_dataframe() # Print the first five rows transactions_by_date.head() # Extra: visualize the result transactions_by_date.set_index('trans_date').plot() 6. Combining Data Sources For the last clause in this course, we will learn about JOIN — INNER JOIN in this section. For INNERJOIN, a row will only be selected if the column that we used to combine in one table also matches with the table that we used for joining. JOIN clause allows us to query and combine the information from different tables. For example, we have two tables; one contains the pet name and the other one contains the pet’s owner name. Here how we can associate the pet with its owner:\nquery = \"\"\" SELECT p.Name AS Pet_Name, 0.Name AS Owner_Name FROM `bigquery-public-data.pet_records.pets` AS P INNER JOIN bigquery-public-data.pet_records.owners` AS O ON p.ID = o.Pet_ID \"\"\" Here’s another example where we want to find how many files are covered by each type of software license on GitHub.\nquery = \"\"\" SELECT L.license, COUNT(1) AS number_of_files FROM `bigquery-public-data.github_repos.sample_files` AS sf INNER JOIN `bigquery-public-data.github_repos.licenses` AS L ON sf.repo_name = L.repo_name GROUP BY L.license ORDER BY number_of_files DESC \"\"\" # limit how much data will be scanned safe_config = bigquery.QueryJobConfig(maximum_bytes_billed=10**10) query_job = client.query(query, job_config=safe_config) # run query and convert to data frame file_count_by_license = query_job.to_dataframe() file_count_by_license ",
  "wordCount" : "1295",
  "inLanguage": "en",
  "image": "http://localhost:1313/home/papermod-cover.png","datePublished": "2023-03-15T00:00:00Z",
  "dateModified": "2023-03-15T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Kean Teng Blog"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/home/docs/2023/2023-03-15-intro-to-sql/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Kean Teng Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://i.postimg.cc/0Qq5g2fX/favicon.png"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/home/" accesskey="h" title="Kean Teng Blog (Alt + H)">Kean Teng Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                    <li>
                        <a href="http://localhost:1313/home/ja/" title="日本語"
                            aria-label="日本語">日本語</a>
                    </li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/home/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/home/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/home/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/home/faqs/" title="FAQs">
                    <span>FAQs</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/home/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/home/docs/">Docs</a></div>
    <h1 class="post-title entry-hint-parent">
      Intro to SQL
    </h1>
    <div class="post-description">
      My Kaggle Learning Note 4
    </div>
    <div class="post-meta"><span title='2023-03-15 00:00:00 +0000 UTC'>March 15, 2023</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;Kean Teng Blog&nbsp;|&nbsp;<a href="https://github.com/keanteng/home/tree/main/content/docs/2023/2023-03-15-intro-to-sql/index.md" rel="noopener noreferrer" target="_blank">Suggest Changes</a>

</div>
  </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">Table of Contents</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#1-data-preparation" aria-label="1. Data Preparation">1. Data Preparation</a><ul>
                            
                    <li>
                        <a href="#11-table-schema" aria-label="1.1 Table Schema">1.1 Table Schema</a></li></ul>
                    </li>
                    <li>
                        <a href="#2-queries-foundations" aria-label="2. Queries Foundations">2. Queries Foundations</a><ul>
                            
                    <li>
                        <a href="#21-big-datasets" aria-label="2.1 Big Datasets">2.1 Big Datasets</a></li></ul>
                    </li>
                    <li>
                        <a href="#3-more-queries-1" aria-label="3. More Queries 1">3. More Queries 1</a></li>
                    <li>
                        <a href="#4-more-queries-2" aria-label="4. More Queries 2">4. More Queries 2</a></li>
                    <li>
                        <a href="#5-more-queries-3" aria-label="5. More Queries 3">5. More Queries 3</a></li>
                    <li>
                        <a href="#6-combining-data-sources" aria-label="6. Combining Data Sources">6. Combining Data Sources</a>
                    </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
         
         activeElement = elements[0];
         const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
         document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
     }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 && 
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
             const id = encodeURI(element.getAttribute('id')).toLowerCase();
             if (element === activeElement){
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
             } else {
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
             }
         })
     }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
</script>

  <div class="post-content"><center><img src="images/img1.png"  class = "center"/></center>
<p style="text-align: center; color:grey;"><i>Images from Unsplash</i></p>
<blockquote>
<p><em>Disclaimer: This article is my learning note from the courses I took from Kaggle.</em></p></blockquote>
<p>For examining and assessing huge datasets and databases, SQL or structured programming language skills plays a vital role to enable us to design and manage data.</p>
<p>Some <strong>common keywords</strong> used in SQL as follows:</p>
<ul>
<li><code>SELECT</code>, <code>WHERE</code>, <code>FROM</code></li>
<li><code>GROUP BY</code>, <code>HAVING</code>, <code>COUNT</code></li>
<li><code>ORDER BY</code></li>
<li><code>AS</code>, <code>WITH</code></li>
<li><code>JOIN</code></li>
</ul>
<h2 id="1-data-preparation">1. Data Preparation<a hidden class="anchor" aria-hidden="true" href="#1-data-preparation">#</a></h2>
<p>Since we will be using Python to apply SQL, there are some steps required for data preparation. We will first start by establishing a connection to the BigQuery service to create a client object that hold projects. We will then select a project from the <em>biquery-public-data</em> which holds a collection of datasets for each project. The datasets will contain the tables that we want for our analysis. Here’s how we can do that in Python:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">google.cloud</span> <span class="kn">import</span> <span class="n">bigquery</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 1. create a client object</span>
</span></span><span class="line"><span class="cl"><span class="n">client</span> <span class="o">=</span> <span class="n">bigquery</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">dataset_ref</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">dataset</span><span class="p">(</span><span class="s2">&#34;hacker-news&#34;</span><span class="p">,</span> <span class="n">project</span> <span class="o">=</span> <span class="s2">&#34;bigquery-public-data&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 2. get the hacker news dataset from a project</span>
</span></span><span class="line"><span class="cl"><span class="n">dataset</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_dataset</span><span class="p">(</span><span class="n">dataset_ref</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 3. list the tables in the datasets</span>
</span></span><span class="line"><span class="cl"><span class="n">tables</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">list_tables</span><span class="p">(</span><span class="n">dataset</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 4. print the all the table names</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">table</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">table_id</span><span class="p">)</span>
</span></span></code></pre></div><p>Now from the code we learn about all the table names in the datasets from the printed outputs. Here’s how we can fetch the table with code:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="c1"># create a reference to the table name full</span>
</span></span><span class="line"><span class="cl"><span class="n">table_ref</span> <span class="o">=</span> <span class="n">dataset_ref</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s2">&#34;full&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># get the table</span>
</span></span><span class="line"><span class="cl"><span class="n">table</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_table</span><span class="p">(</span><span class="n">table_ref</span><span class="p">)</span>
</span></span></code></pre></div><p>Oftentimes, when we want to preview at the table before our analysis, but it contains a huge number of rows and might consume resources to load, we can choose to display only a certain number of rows of the table.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="c1"># Restrict rows and convert the result to dataframe</span>
</span></span><span class="line"><span class="cl"><span class="n">client</span><span class="o">.</span><span class="n">list_rows</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">max_results</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
</span></span></code></pre></div><h3 id="11-table-schema">1.1 Table Schema<a hidden class="anchor" aria-hidden="true" href="#11-table-schema">#</a></h3>
<p>The structure of a table is known as table schema, and it will tell us information about each specific columns in our table. The information is:</p>
<ul>
<li><code>Name</code> of the column</li>
<li><code>Datatype</code> of the column</li>
<li><code>Mode</code> of the column (by default it will allow null values — nullable)</li>
<li><code>Description</code> of the data in the particular column</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="c1"># code command</span>
</span></span><span class="line"><span class="cl"><span class="n">table</span><span class="o">.</span><span class="n">schema</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Output:</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">SchemaField</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;STRING&#39;</span><span class="p">,</span> <span class="s1">&#39;NULLABLE&#39;</span><span class="p">,</span> <span class="s1">&#39;Story title&#39;</span><span class="p">,</span> <span class="p">(),</span> <span class="kc">None</span><span class="p">)]</span>
</span></span></code></pre></div><h2 id="2-queries-foundations">2. Queries Foundations<a hidden class="anchor" aria-hidden="true" href="#2-queries-foundations">#</a></h2>
<p>We will start by three keywords which represents the foundational components of a SQL query, namely <code>SELECT</code>, <code>FROM</code> and <code>WHERE</code>.</p>
<p>By <code>SELECT</code>, it refers to the columns that we want to select, FROM refers to the table that we are after and finally WHERE refers to the return condition that we want to impose on the output. Below is how we can select the cat owner’s name from an imaginary dataset:</p>
<center><img src="images/img2.png"  class = "center"/></center>
<p style="text-align: center; color:grey;"><i>An imaginary dataset</i></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">query</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  SELECT Name 
</span></span></span><span class="line"><span class="cl"><span class="s2">  FROM `bigquery-public-data.pet_records.pets`
</span></span></span><span class="line"><span class="cl"><span class="s2">  WHERE Animal = &#39;Dog&#39;
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span></code></pre></div><h3 id="21-big-datasets">2.1 Big Datasets<a hidden class="anchor" aria-hidden="true" href="#21-big-datasets">#</a></h3>
<p>Some BigQuery datasets can be huge and costly to compute. If you are running them on cloud services with limited computing hours, your limit might drain easily with huge datasets. We can avoid this issue by imposing a function to limit the amount of data that we are capable to scan to avoid running over our computing limit.</p>
<p>Here’s how we can check how much data a query will scan, alternatively we can also impose a limit with a parameter on how much data that will be scanned:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="c1"># query</span>
</span></span><span class="line"><span class="cl"><span class="n">query</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  SELECT score, title
</span></span></span><span class="line"><span class="cl"><span class="s2">  FROM `bigquery-public-data.hacker_news.full`
</span></span></span><span class="line"><span class="cl"><span class="s2">  WHERE type = &#34;job&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## 1. Cost estimation</span>
</span></span><span class="line"><span class="cl"><span class="c1"># create object for cost estimation without running it</span>
</span></span><span class="line"><span class="cl"><span class="n">dry_run_config</span> <span class="o">=</span> <span class="n">bigquery</span><span class="o">.</span><span class="n">QueryJobConfig</span><span class="p">(</span><span class="n">dry_run</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># estimate cost</span>
</span></span><span class="line"><span class="cl"><span class="n">dry_run_query_job</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">job_config</span> <span class="o">=</span> <span class="n">dry_run_config</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;This query will process </span><span class="si">{}</span><span class="s2"> bytes.&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dry_run_query_job</span><span class="o">.</span><span class="n">total_bytes_processed</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## 2. Setting parameter</span>
</span></span><span class="line"><span class="cl"><span class="n">ONE_GB</span> <span class="o">=</span> <span class="mi">1000</span><span class="o">*</span><span class="mi">1000</span><span class="o">*</span><span class="mi">1000</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># set up the query</span>
</span></span><span class="line"><span class="cl"><span class="n">safe_config</span> <span class="o">=</span> <span class="n">bigquery</span><span class="o">.</span><span class="n">QueryJobConfig</span><span class="p">(</span><span class="n">maximum_bytes_billed</span> <span class="o">=</span> <span class="n">ONE_GB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># run the query</span>
</span></span><span class="line"><span class="cl"><span class="n">safe_query_job</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">job_config</span> <span class="o">=</span> <span class="n">safe_config</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">job_posts_scores</span> <span class="o">=</span> <span class="n">safe_query_job</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">job_posts_scores</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</span></span></code></pre></div><h2 id="3-more-queries-1">3. More Queries 1<a hidden class="anchor" aria-hidden="true" href="#3-more-queries-1">#</a></h2>
<p>This section will add three new techniques: <code>GROUP BY</code>, <code>HAVING</code> and <code>COUNT()</code> to assist us in getting more interesting insights from our queries.</p>
<p><code>GROUP BY</code> means grouping together rows with the same value in that column as a single group, <code>COUNT()</code> will return a count of things such as the number of entries of a column while <code>HAVING</code> is used in combination with <code>GROUP BY</code> to ignore groups that do not meet a certain criterion.</p>
<p>Here is how we can apply these techniques to find the most discussed new comments on the Hacker News project:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="c1"># select comment with &gt; 10 replies</span>
</span></span><span class="line"><span class="cl"><span class="n">query_popular</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">                SELECT parent, COUNT(1) AS NumPosts
</span></span></span><span class="line"><span class="cl"><span class="s2">                FROM `bigquery-public-data.hacker_news.comments`
</span></span></span><span class="line"><span class="cl"><span class="s2">                GROUP BY parent
</span></span></span><span class="line"><span class="cl"><span class="s2">                HAVING COUNT(1) &gt; 10
</span></span></span><span class="line"><span class="cl"><span class="s2">                &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># limit how much data will be scan</span>
</span></span><span class="line"><span class="cl"><span class="n">safe_config</span> <span class="o">=</span> <span class="n">bigquery</span><span class="o">.</span><span class="n">QueryJobConfig</span><span class="p">(</span><span class="n">maximum_bytes_billed</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">query_job</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query_popular</span><span class="p">,</span> <span class="n">job_config</span><span class="o">=</span><span class="n">safe_config</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># run query and convert to data frame</span>
</span></span><span class="line"><span class="cl"><span class="n">popular_comments</span> <span class="o">=</span> <span class="n">query_job</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># print the first five rows</span>
</span></span><span class="line"><span class="cl"><span class="n">popular_comments</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></div><h2 id="4-more-queries-2">4. More Queries 2<a hidden class="anchor" aria-hidden="true" href="#4-more-queries-2">#</a></h2>
<p>In this section, we will learn about <code>ORDER BY</code> clause where it is used to sort the returned results by the rest of the query. When we use ORDER BY the returned results will be sorted in ascending order whether it is string or numeric. If we would like to have the order reverse, we can add in the <code>DESC</code> argument.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">query</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  SELECT Name 
</span></span></span><span class="line"><span class="cl"><span class="s2">  FROM `bigquery-public-data.pet_records.pets`
</span></span></span><span class="line"><span class="cl"><span class="s2">  WHERE Animal = &#39;Dog&#39;
</span></span></span><span class="line"><span class="cl"><span class="s2">  ORDER BY Name DESC
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span></code></pre></div><p>Now considering we have a column that tell us about the date that a pet owner getting a pet, we can use the <code>EXTRACT</code> clause to get the day, month, week and year information from the column.</p>
<h2 id="5-more-queries-3">5. More Queries 3<a hidden class="anchor" aria-hidden="true" href="#5-more-queries-3">#</a></h2>
<p>In this section, we will work on two keywords that helps to organize our query for better readability — if we happen we have a complex query. Starting with <code>AS</code>, it is used to rename columns generated by our queries. <code>WITH</code> is used together with <code>AS</code> to create a temporary table so that we can write query against them. This helps us to split queries into readable chunks and makes the data cleaning work easier.</p>
<p>Consider that we want to know the pet IDs that are owned for more than five years:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">query</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  WITH Seniors AS
</span></span></span><span class="line"><span class="cl"><span class="s2">  (
</span></span></span><span class="line"><span class="cl"><span class="s2">    SELECT Name, ID
</span></span></span><span class="line"><span class="cl"><span class="s2">    FROM `bigquery-public-data.pet_records.pets`
</span></span></span><span class="line"><span class="cl"><span class="s2">    WHERE Years_old &gt; 5
</span></span></span><span class="line"><span class="cl"><span class="s2">  )
</span></span></span><span class="line"><span class="cl"><span class="s2">  SELECT ID
</span></span></span><span class="line"><span class="cl"><span class="s2">  FROM Seniors
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span></code></pre></div><p>Another example is to find how many bitcoins transactions being made in a month:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">query</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  WITH Time AS 
</span></span></span><span class="line"><span class="cl"><span class="s2">  (
</span></span></span><span class="line"><span class="cl"><span class="s2">    SELECT DATE(block_timestamp) AS trans_date
</span></span></span><span class="line"><span class="cl"><span class="s2">    FROM `bigquery-public-data.crypto_bitcoin.transactions`
</span></span></span><span class="line"><span class="cl"><span class="s2">  )
</span></span></span><span class="line"><span class="cl"><span class="s2">  SELECT COUNT(1) AS transactions, trans_date
</span></span></span><span class="line"><span class="cl"><span class="s2">  FROM Time
</span></span></span><span class="line"><span class="cl"><span class="s2">  GROUP BY trans_date
</span></span></span><span class="line"><span class="cl"><span class="s2">  ORDER BY trans_date
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># limit how much data will be scanned</span>
</span></span><span class="line"><span class="cl"><span class="n">safe_config</span> <span class="o">=</span> <span class="n">bigquery</span><span class="o">.</span><span class="n">QueryJobConfig</span><span class="p">(</span><span class="n">maximum_bytes_billed</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">query_job</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">job_config</span><span class="o">=</span><span class="n">safe_config</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># run query and convert to data frame</span>
</span></span><span class="line"><span class="cl"><span class="n">transactions_by_date</span> <span class="o">=</span> <span class="n">query_job</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Print the first five rows</span>
</span></span><span class="line"><span class="cl"><span class="n">transactions_by_date</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Extra: visualize the result</span>
</span></span><span class="line"><span class="cl"><span class="n">transactions_by_date</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;trans_date&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</span></span></code></pre></div><h2 id="6-combining-data-sources">6. Combining Data Sources<a hidden class="anchor" aria-hidden="true" href="#6-combining-data-sources">#</a></h2>
<p>For the last clause in this course, we will learn about <code>JOIN — INNER JOIN</code> in this section. For <code>INNERJOIN</code>, a row will only be selected if the column that we used to combine in one table also matches with the table that we used for joining. <code>JOIN</code> clause allows us to query and combine the information from different tables. For example, we have two tables; one contains the pet name and the other one contains the pet’s owner name. Here how we can associate the pet with its owner:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">query</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  SELECT p.Name AS Pet_Name, 0.Name AS Owner_Name
</span></span></span><span class="line"><span class="cl"><span class="s2">  FROM `bigquery-public-data.pet_records.pets` AS P
</span></span></span><span class="line"><span class="cl"><span class="s2">  INNER JOIN bigquery-public-data.pet_records.owners` AS O
</span></span></span><span class="line"><span class="cl"><span class="s2">    ON p.ID = o.Pet_ID
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span> 
</span></span></code></pre></div><p>Here’s another example where we want to find how many files are covered by each type of software license on GitHub.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">query</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">        SELECT L.license, COUNT(1) AS number_of_files
</span></span></span><span class="line"><span class="cl"><span class="s2">        FROM `bigquery-public-data.github_repos.sample_files` AS sf
</span></span></span><span class="line"><span class="cl"><span class="s2">        INNER JOIN `bigquery-public-data.github_repos.licenses` AS L 
</span></span></span><span class="line"><span class="cl"><span class="s2">            ON sf.repo_name = L.repo_name
</span></span></span><span class="line"><span class="cl"><span class="s2">        GROUP BY L.license
</span></span></span><span class="line"><span class="cl"><span class="s2">        ORDER BY number_of_files DESC
</span></span></span><span class="line"><span class="cl"><span class="s2">        &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># limit how much data will be scanned</span>
</span></span><span class="line"><span class="cl"><span class="n">safe_config</span> <span class="o">=</span> <span class="n">bigquery</span><span class="o">.</span><span class="n">QueryJobConfig</span><span class="p">(</span><span class="n">maximum_bytes_billed</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">query_job</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">job_config</span><span class="o">=</span><span class="n">safe_config</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># run query and convert to data frame</span>
</span></span><span class="line"><span class="cl"><span class="n">file_count_by_license</span> <span class="o">=</span> <span class="n">query_job</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">file_count_by_license</span>
</span></span></code></pre></div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/home/tags/python/">Python</a></li>
      <li><a href="http://localhost:1313/home/tags/sql/">SQL</a></li>
      <li><a href="http://localhost:1313/home/tags/data-analysis/">Data Analysis</a></li>
      <li><a href="http://localhost:1313/home/tags/kaggle/">Kaggle</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/home/docs/2023/2023-03-20-computer-vision/">
    <span class="title">« Prev</span>
    <br>
    <span>Computer Vision</span>
  </a>
  <a class="next" href="http://localhost:1313/home/docs/2023/2023-03-02-intermediate-machine-learning/">
    <span class="title">Next »</span>
    <br>
    <span>Intermediate Machine Learning</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Intro to SQL on x"
            href="https://x.com/intent/tweet/?text=Intro%20to%20SQL&amp;url=http%3a%2f%2flocalhost%3a1313%2fhome%2fdocs%2f2023%2f2023-03-15-intro-to-sql%2f&amp;hashtags=Python%2cSQL%2cDataAnalysis%2cKaggle">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Intro to SQL on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fhome%2fdocs%2f2023%2f2023-03-15-intro-to-sql%2f&amp;title=Intro%20to%20SQL&amp;summary=Intro%20to%20SQL&amp;source=http%3a%2f%2flocalhost%3a1313%2fhome%2fdocs%2f2023%2f2023-03-15-intro-to-sql%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Intro to SQL on reddit"
            href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fhome%2fdocs%2f2023%2f2023-03-15-intro-to-sql%2f&title=Intro%20to%20SQL">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Intro to SQL on facebook"
            href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fhome%2fdocs%2f2023%2f2023-03-15-intro-to-sql%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Intro to SQL on whatsapp"
            href="https://api.whatsapp.com/send?text=Intro%20to%20SQL%20-%20http%3a%2f%2flocalhost%3a1313%2fhome%2fdocs%2f2023%2f2023-03-15-intro-to-sql%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Intro to SQL on telegram"
            href="https://telegram.me/share/url?text=Intro%20to%20SQL&amp;url=http%3a%2f%2flocalhost%3a1313%2fhome%2fdocs%2f2023%2f2023-03-15-intro-to-sql%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Intro to SQL on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=Intro%20to%20SQL&u=http%3a%2f%2flocalhost%3a1313%2fhome%2fdocs%2f2023%2f2023-03-15-intro-to-sql%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer><script src="https://giscus.app/client.js"
        data-repo="keanteng/home"
        data-repo-id="R_kgDOJUcFvg"
        data-category="General"
        data-category-id="DIC_kwDOJUcFvs4CeIVI"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="preferred_color_scheme"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/home/">Kean Teng Blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
